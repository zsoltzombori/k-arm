import data
from model import *

dataset = 'mnist'
batch_size = 128
nb_epoch = 5

if dataset == 'mnist':
    (X_train, Y_train), (X_test, Y_test), datagen, test_datagen, nb_classes = data.load_mnist()


input_shape = list(X_train.shape)
input_shape[0] = batch_size
model = build_model(input_shape=input_shape, nb_classes=nb_classes, layer_count=1)

nb_val_samples = X_test.shape[0]
samples_per_epoch = X_train.shape[0]
   
# fit the model on the batches generated by datagen.flow()
model.fit_generator(datagen.flow(X_train, Y_train, batch_size=batch_size, shuffle=True),
                        samples_per_epoch=samples_per_epoch,
                        nb_epoch=nb_epoch,
                        validation_data=test_datagen.flow(X_test, Y_test, batch_size=batch_size),
                        nb_val_samples=nb_val_samples
                        )
